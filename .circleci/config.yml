# # PHP CircleCI 2.0 configuration file
# #
# # Check https://circleci.com/docs/2.0/language-php/ for more details
# #
# version: 2
# jobs:
#   build:
#     docker:
#       # specify the version you desire here
#       - image: circleci/php:7.1.5-browsers
      
#       # Specify service dependencies here if necessary
#       # CircleCI maintains a library of pre-built images
#       # documented at https://circleci.com/docs/2.0/circleci-images/
#       # - image: circleci/mysql:9.4

#     working_directory: ~/repo

#     steps:
#       - checkout

#       # Download and cache dependencies
#       - restore_cache:
#           keys:
#           - v1-dependencies-{{ checksum "composer.json" }}
#           # fallback to using the latest cache if no exact match is found
#           - v1-dependencies-

#       - run: composer install -n --prefer-dist

#       - save_cache:
#           paths:
#             - ./vendor
#           key: v1-dependencies-{{ checksum "composer.json" }}
        
#       # run tests!
#       - run: phpunit
version: 2.0
jobs:
  test:
    machine:
      php:
      version: 5.6.22
      environment:
      PATH: $HOME/.composer/vendor/bin:$PATH

    dependencies:
      pre:
      - sudo apt-get update; sudo apt-get install subversion

    test:
      pre:
      - bash bin/install-wp-tests.sh wordpress_test ubuntu '' 127.0.0.1 latest
      - |
      composer global require wp-coding-standards/wpcs
      phpcs --config-set installed_paths $HOME/.composer/vendor/wp-coding-standards/wpcs
      override:
      - phpcs --standard=phpcs.ruleset.xml $(find . -name '*.php')
      - phpunit